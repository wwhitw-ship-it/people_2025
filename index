<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çŸ­å½±éŸ³å‰ªè¼¯å¸«æˆé•·å›é¡§è¡¨</title>
   
    <!-- å¼•å…¥ React å’Œ Tailwind (è®“ç€è¦½å™¨èƒ½ç›´æ¥åŸ·è¡Œç¨‹å¼) -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
   
    <style>
        /* åˆ—å°èˆ‡ PDF è¼¸å‡ºå°ˆç”¨æ¨£å¼ */
        @media print {
            @page {
                size: A4;
                margin: 12mm;
            }
            body {
                background: white;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            .no-print { display: none !important; }
            .print-break-inside-avoid { break-inside: avoid; page-break-inside: avoid; }
            .shadow-lg, .shadow-sm {
                box-shadow: none !important;
                border: 1px solid #e5e7eb;
            }
        }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .animate-spin { animation: spin 1s linear infinite; }
    </style>
</head>
<body class="bg-gray-100 font-sans text-gray-800">
    <div id="root"></div>


    <script type="text/babel">
        const { useState } = React;


        // --- å…§å»ºåœ–ç¤ºå…ƒä»¶ ---
        const IconBase = ({ children, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{children}</svg>
        );
        const Save = ({ className }) => <IconBase className={className}><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></IconBase>;
        const Printer = ({ className }) => <IconBase className={className}><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></IconBase>;
        const MessageSquare = ({ className }) => <IconBase className={className}><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></IconBase>;
        const Award = ({ className }) => <IconBase className={className}><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></IconBase>;
        const Zap = ({ className }) => <IconBase className={className}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></IconBase>;
        const Users = ({ className }) => <IconBase className={className}><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></IconBase>;
        const CheckCircle = ({ className }) => <IconBase className={className}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></IconBase>;
        const Calculator = ({ className }) => <IconBase className={className}><rect x="4" y="2" width="16" height="20" rx="2"/><line x1="8" y1="6" x2="16" y2="6"/><line x1="16" y1="14" x2="16" y2="14"/><line x1="12" y1="14" x2="12" y2="14"/><line x1="8" y1="14" x2="8" y2="14"/><line x1="16" y1="18" x2="16" y2="18"/><line x1="12" y1="18" x2="12" y2="18"/><line x1="8" y1="18" x2="8" y2="18"/></IconBase>;
        const CloudUpload = ({ className }) => <IconBase className={className}><path d="M20.49 15a9 9 0 1 0-17.98 0 7 7 0 0 0-1.51 15H20a8 8 0 0 0 .49-16z"/><polyline points="16 16 12 12 8 16"/><line x1="12" y1="12" x2="12" y2="21"/></IconBase>;
        const Loader = ({ className }) => <IconBase className={`${className} animate-spin`}><path d="M21 12a9 9 0 1 1-6.219-8.56"/></IconBase>;
        const Info = ({ className }) => <IconBase className={className}><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></IconBase>;


        // --- ä¸»æ‡‰ç”¨ç¨‹å¼ ---
        const EvaluationForm = () => {
           
            // ğŸ”´ ğŸ”´ ğŸ”´ å¦‚æœæ‚¨ä¹‹å¾Œè¦ç”¨ Google Sheetsï¼Œè«‹æŠŠç¶²å€è²¼åœ¨é€™è£¡ï¼›è‹¥ä¸ç”¨å‰‡ç•™ç©ºå³å¯ ğŸ”´ ğŸ”´ ğŸ”´
            const GOOGLE_SCRIPT_URL = "";
            // -------------------------------------------------------------


            const [isSubmitting, setIsSubmitting] = useState(false);
            const [formData, setFormData] = useState({
                employeeName: '',
                department: 'å½±éŸ³å…§å®¹éƒ¨',
                role: 'çŸ­å½±éŸ³å‰ªè¼¯å¸«',
                date: new Date().toISOString().split('T')[0],
                skills_software: 0, skills_storytelling: 0, skills_aesthetic: 0, skills_trend: 0,
                eff_speed: 0, eff_precision: 0, eff_file_management: 0, eff_revision: 0,
                culture_comm: 0, culture_proactive: 0, culture_growth: 0, culture_responsibility: 0,
                feedback_highlight: '', feedback_challenges: '', feedback_goals: '',
            });


            const [viewMode, setViewMode] = useState('edit');


            const handleInputChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
            };


            const handleScoreChange = (name, value) => {
                setFormData(prev => ({ ...prev, [name]: value }));
            };


            const calculateStats = () => {
                const scores = [
                    formData.skills_software, formData.skills_storytelling, formData.skills_aesthetic, formData.skills_trend,
                    formData.eff_speed, formData.eff_precision, formData.eff_file_management, formData.eff_revision,
                    formData.culture_comm, formData.culture_proactive, formData.culture_growth, formData.culture_responsibility
                ];
                const totalScore = scores.reduce((a, b) => a + parseInt(b || 0), 0);
                const filledCount = scores.filter(s => s > 0).length;
                const totalQuestions = 12;
                const maxScore = totalQuestions * 5;
                const averageScore = filledCount === 0 ? 0 : (totalScore / filledCount).toFixed(1);
                return { totalScore, maxScore, averageScore, filledCount, totalQuestions };
            };


            const stats = calculateStats();


            const submitToGoogleSheets = async () => {
                if (!GOOGLE_SCRIPT_URL) {
                    alert("âš ï¸ ç›®å‰å°šæœªè¨­å®š Google Sheets é€£å‹•ã€‚\n\nè‹¥æ‚¨åƒ…éœ€è¦ã€Œè½‰å­˜ PDFã€åŠŸèƒ½ï¼Œè«‹ç›´æ¥é»é¸æ—é‚Šçš„ã€Œåˆ—å° / è½‰ PDFã€æŒ‰éˆ•å³å¯ï¼\n\n(è‹¥è¦å•Ÿç”¨é›²ç«¯åŠŸèƒ½ï¼Œè«‹åƒè€ƒæ•™å­¸å–å¾—ç¶²å€ä¸¦å¡«å…¥ç¨‹å¼ç¢¼ä¸­)");
                    return;
                }
                if (!formData.employeeName) { alert("è«‹å¡«å¯«å§“åå¾Œå†ä¸Šå‚³ï¼"); return; }
                if (window.confirm(`ç¢ºå®šè¦ä¸Šå‚³ ${formData.employeeName} çš„è‡ªè©•è³‡æ–™å—ï¼Ÿ`)) {
                    setIsSubmitting(true);
                    try {
                        const payload = {
                            ...formData,
                            totalScore: stats.totalScore,
                            averageScore: stats.averageScore,
                            submittedAt: new Date().toLocaleString()
                        };
                        await fetch(GOOGLE_SCRIPT_URL, {
                            method: "POST",
                            body: JSON.stringify(payload),
                            headers: { "Content-Type": "text/plain;charset=utf-8" },
                            mode: 'no-cors'
                        });
                        alert("ğŸ‰ è³‡æ–™ä¸Šå‚³æˆåŠŸï¼");
                    } catch (error) {
                        console.error("Upload Error:", error);
                        alert("ä¸Šå‚³å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚");
                    } finally {
                        setIsSubmitting(false);
                    }
                }
            };


            // è©•åˆ†æ¨™æº–èªªæ˜å…ƒä»¶ (Scoring Legend)
            const ScoringLegend = () => (
                <div className="mb-8 p-4 bg-gray-50 rounded-lg border border-gray-200 print-break-inside-avoid">
                    <h3 className="flex items-center gap-2 font-bold text-gray-700 mb-3 text-sm uppercase tracking-wide">
                        <Info className="w-4 h-4" /> è©•åˆ†æ¨™æº–èªªæ˜
                    </h3>
                    <div className="grid grid-cols-1 md:grid-cols-5 gap-2 text-xs md:text-sm">
                        <div className="p-2 rounded bg-blue-100 border border-blue-200 text-blue-800">
                            <span className="font-bold block text-lg">5 åˆ†</span>
                            <span className="font-medium">è¡¨ç¾å„ªç•°</span>
                            <p className="opacity-80 text-xs mt-1">é è¶…æ¨™æº–ï¼Œæˆç‚ºå…¸ç¯„</p>
                        </div>
                        <div className="p-2 rounded bg-green-100 border border-green-200 text-green-800">
                            <span className="font-bold block text-lg">4 åˆ†</span>
                            <span className="font-medium">è¡¨ç¾è‰¯å¥½</span>
                            <p className="opacity-80 text-xs mt-1">é«˜æ–¼æ¨™æº–ï¼Œå“è³ªç©©å®š</p>
                        </div>
                        <div className="p-2 rounded bg-gray-100 border border-gray-200 text-gray-800">
                            <span className="font-bold block text-lg">3 åˆ†</span>
                            <span className="font-medium">é”åˆ°æ¨™æº–</span>
                            <p className="opacity-80 text-xs mt-1">ç¬¦åˆé æœŸï¼Œç¨ç«‹å®Œæˆ</p>
                        </div>
                        <div className="p-2 rounded bg-orange-50 border border-orange-200 text-orange-800">
                            <span className="font-bold block text-lg">2 åˆ†</span>
                            <span className="font-medium">éœ€æ”¹å–„</span>
                            <p className="opacity-80 text-xs mt-1">ç¨å¾®ä¸è¶³ï¼Œéœ€éƒ¨åˆ†èª¿æ•´</p>
                        </div>
                        <div className="p-2 rounded bg-red-50 border border-red-200 text-red-800">
                            <span className="font-bold block text-lg">1 åˆ†</span>
                            <span className="font-medium">æœªé”æ¨™</span>
                            <p className="opacity-80 text-xs mt-1">è¡¨ç¾ä¸è¶³ï¼Œéœ€å¤§å¹…æŒ‡å°</p>
                        </div>
                    </div>
                </div>
            );


            const categories = [
                {
                    id: 'part1',
                    title: 'ä¸€ã€å°ˆæ¥­æŠ€èƒ½èˆ‡ç¶²æ„Ÿ (Professional Skills)',
                    icon: <Zap className="w-5 h-5 text-yellow-500" />,
                    desc: 'è©•ä¼°æŠ€è¡“ç¡¬å¯¦åŠ›èˆ‡å°å…§å®¹çš„æ•éŠ³åº¦',
                    items: [
                        { id: 'skills_software', label: 'è»Ÿé«”é§•é¦­èˆ‡ AI è³¦èƒ½', sub: 'æ˜¯å¦é¡˜æ„å˜—è©¦åŠé‹ç”¨è»Ÿé«”å·¥å…·æˆ– AIå·¥å…·ï¼Œç‚ºå‰µä½œåŠ åˆ†' },
                        { id: 'skills_storytelling', label: 'çŸ­å½±éŸ³æ•˜äº‹åŠ›', sub: 'ç²¾æº–æŒæ¡é»ƒé‡‘ 3 ç§’ (Hook)ï¼Œç¯€å¥å¼•äººå…¥å‹' },
                        { id: 'skills_aesthetic', label: 'è¦–è¦ºç¾æ„Ÿèˆ‡åŒ…è£', sub: 'å­—å¹•èˆ‡ç‰¹æ•ˆå…·å‚™è¨­è¨ˆæ„Ÿï¼Œç²¾æº–å‚³éå“ç‰Œè³ªæ„Ÿ' },
                        { id: 'skills_trend', label: 'è¶¨å‹¢æ•éŠ³åº¦ (ç¶²æ„Ÿ)', sub: 'å°æµè¡Œè¶¨å‹¢é«˜æ•æ„Ÿï¼Œèƒ½å°‡æ–°æ¢—è½‰åŒ–ç‚ºé¤Šåˆ†' }
                    ]
                },
                {
                    id: 'part2',
                    title: 'äºŒã€å·¥ä½œæ•ˆèƒ½èˆ‡å“è³ª (Efficiency & Quality)',
                    icon: <CheckCircle className="w-5 h-5 text-green-500" />,
                    desc: 'è©•ä¼°ç”¢å‡ºç¯€å¥èˆ‡ç´°ç¯€æ§ç®¡',
                    items: [
                        { id: 'eff_speed', label: 'ç”¢å‡ºç¯€å¥èˆ‡æ•ˆèƒ½', sub: 'åœ¨æ™‚ç¨‹å…§ç©©å®šç”¢å‡ºï¼Œå±•ç¾è‰¯å¥½æ™‚é–“ç®¡ç†' },
                        { id: 'eff_precision', label: 'æˆå“ç²¾æº–åº¦', sub: 'å°ç´°ç¯€æœ‰é«˜æ¨™æº–ï¼Œç¢ºä¿é«˜å“è³ªè¼¸å‡º (ä½éŒ¯å­—/ä½å¤±èª¤)' },
                        { id: 'eff_file_management', label: 'æª”æ¡ˆç®¡ç†é‚è¼¯', sub: 'å…·å‚™æ¸…æ™°æ­¸æª”ç¿’æ…£ï¼Œç‚ºåœ˜éšŠå»ºç«‹è‰¯å¥½è³‡ç”¢åº«' },
                        { id: 'eff_revision', label: 'éœ€æ±‚å°ç„¦èˆ‡è¿­ä»£', sub: 'èƒ½å¿«é€ŸæŠ“æº–å„ªåŒ–æ–¹å‘ï¼Œè®“ä½œå“è¶Šæ”¹è¶Šå¥½' }
                    ]
                },
                {
                    id: 'part3',
                    title: 'ä¸‰ã€åœ˜éšŠå”ä½œèˆ‡æ–‡åŒ– (Culture & Growth)',
                    icon: <Users className="w-5 h-5 text-blue-500" />,
                    desc: 'è©•ä¼°æºé€šæ¨¡å¼èˆ‡æˆé•·å¿ƒæ…‹',
                    items: [
                        { id: 'culture_comm', label: 'æºé€šèˆ‡è¿­ä»£å¿ƒæ…‹', sub: 'æ¨‚æ–¼æ¥æ”¶å»ºè­°ï¼Œå°‡å›é¥‹è¦–ç‚ºå‡ç´šæ©Ÿæœƒ' },
                        { id: 'culture_proactive', label: 'ä¸»å‹•æ€§èˆ‡è§£æ±ºåŠ›', sub: 'é‡åˆ°æŒ‘æˆ°æ™‚ï¼Œå±•ç¾ä¸»å‹•å°‹æ‰¾è§£æ³•çš„ç†±å¿±' },
                        { id: 'culture_growth', label: 'æˆé•·å‹æ€ç¶­', sub: 'æ¨‚æ–¼åˆ†äº«æ–°çŸ¥ï¼Œé¡˜æ„è·³å‡ºèˆ’é©åœˆå˜—è©¦æ–°é¢¨æ ¼' },
                        { id: 'culture_responsibility', label: 'ç•¶è²¬èˆ‡å”ä½œå½ˆæ€§', sub: 'å°ä½œå“é«˜åº¦è² è²¬ï¼Œä¸¦èƒ½å½ˆæ€§æ”¯æ´åœ˜éšŠ' }
                    ]
                }
            ];


            const RatingInput = ({ value, onChange, label, sub }) => (
                <div className="mb-6 pb-4 border-b border-gray-100 last:border-0 print-break-inside-avoid">
                    <div className="flex flex-col md:flex-row justify-between items-start md:items-center mb-2">
                        <div className="mb-2 md:mb-0 max-w-lg">
                            <h4 className="font-semibold text-gray-800 text-lg">{label}</h4>
                            <p className="text-gray-500 text-sm">{sub}</p>
                        </div>
                        <div className="flex gap-1 bg-gray-50 p-1 rounded-lg">
                            {[1, 2, 3, 4, 5].map((score) => (
                                <button
                                    key={score}
                                    onClick={() => onChange(score)}
                                    className={`w-10 h-10 rounded-md flex items-center justify-center transition-all font-bold ${
                                        value >= score
                                            ? 'bg-blue-600 text-white shadow-md scale-105'
                                            : 'text-gray-400 hover:bg-gray-200'
                                    }`}
                                >
                                    {score}
                                </button>
                            ))}
                        </div>
                    </div>
                </div>
            );


            const SectionHeader = ({ icon, title, desc }) => (
                <div className="flex items-center gap-3 mb-6 p-3 bg-blue-50 rounded-lg border-l-4 border-blue-500 print-break-inside-avoid">
                    {icon}
                    <div>
                        <h3 className="font-bold text-xl text-blue-900">{title}</h3>
                        <p className="text-blue-600 text-sm">{desc}</p>
                    </div>
                </div>
            );


            // é è¦½èˆ‡åˆ—å°å°ˆç”¨é é¢ (Preview Sheet)
            const PreviewSheet = () => (
                <div className="bg-white p-8 max-w-4xl mx-auto shadow-none print:shadow-none print:w-full print:p-0">
                    {/* Header */}
                    <div className="flex justify-between items-end border-b-2 border-blue-600 pb-4 mb-6">
                        <div>
                            <h1 className="text-3xl font-bold text-gray-900">è‡ªæˆ‘æˆé•·å›é¡§è¡¨</h1>
                            <p className="text-gray-500 mt-1">çŸ­å½±éŸ³å‰ªè¼¯å¸«ï½œè©¦ç”¨æœŸè‡ªè©•å ±å‘Š</p>
                        </div>
                        <div className="flex gap-6 text-right">
                            <div>
                                <div className="text-xs text-gray-500 uppercase font-bold tracking-wider">è‡ªè©•ç¸½åˆ†</div>
                                <div className="text-3xl font-bold text-gray-800">
                                    <span className="text-blue-600">{stats.totalScore}</span>
                                    <span className="text-gray-400 text-xl font-normal"> / {stats.maxScore}</span>
                                </div>
                            </div>
                            <div className="border-l border-gray-300 pl-6">
                                <div className="text-xs text-gray-500 uppercase font-bold tracking-wider">è‡ªè©•å¹³å‡</div>
                                <div className="text-3xl font-bold text-blue-600">{stats.averageScore}</div>
                            </div>
                        </div>
                    </div>


                    {/* Basic Info */}
                    <div className="grid grid-cols-2 gap-6 mb-6 bg-gray-50 p-4 rounded-lg print:bg-gray-50 print:border print:border-gray-200">
                        <div>
                            <span className="text-gray-500 text-sm block">å§“å</span>
                            <span className="font-medium text-lg">{formData.employeeName || 'æœªå¡«å¯«'}</span>
                        </div>
                        <div>
                            <span className="text-gray-500 text-sm block">å¡«è¡¨æ—¥æœŸ</span>
                            <span className="font-medium text-lg">{formData.date}</span>
                        </div>
                    </div>


                    {/* Rubric Legend (Shown in Preview) */}
                    <ScoringLegend />


                    {/* Scores */}
                    {categories.map((cat) => (
                        <div key={cat.id} className="mb-8 print-break-inside-avoid">
                            <h3 className="text-lg font-bold text-gray-800 mb-4 border-b border-gray-200 pb-2">{cat.title}</h3>
                            <table className="w-full text-sm">
                                <thead>
                                    <tr className="text-left text-gray-500">
                                        <th className="pb-2 w-2/3">è©•æ ¸é …ç›®</th>
                                        <th className="pb-2 text-right">è‡ªè©•åˆ†æ•¸</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {cat.items.map((item) => (
                                        <tr key={item.id} className="border-b border-gray-100 last:border-0">
                                            <td className="py-2 pr-4">
                                                <div className="font-medium text-gray-800">{item.label}</div>
                                                <div className="text-xs text-gray-500">{item.sub}</div>
                                            </td>
                                            <td className="py-2 text-right font-bold text-blue-600 text-lg">
                                                {formData[item.id] > 0 ? formData[item.id] : '-'}
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    ))}


                    {/* Qualitative */}
                    <div className="mb-8 print-break-inside-avoid">
                        <h3 className="text-lg font-bold text-gray-800 mb-4 border-b border-gray-200 pb-2">å››ã€è‡ªæˆ‘å›é¡§ (Self Reflection)</h3>
                        <div className="bg-blue-50 p-6 rounded-lg print:bg-blue-50 print:border print:border-blue-100">
                            <div className="mb-6">
                                <p className="text-sm text-blue-800 font-bold uppercase mb-2">âœ¨ Highlight æ™‚åˆ»</p>
                                <p className="text-gray-700 whitespace-pre-wrap leading-relaxed">{formData.feedback_highlight || 'ï¼ˆæœªå¡«å¯«ï¼‰'}</p>
                            </div>
                            <div className="mb-6">
                                <p className="text-sm text-blue-800 font-bold uppercase mb-2">ğŸš§ å¡é—œèˆ‡æŒ‘æˆ°</p>
                                <p className="text-gray-700 whitespace-pre-wrap leading-relaxed">{formData.feedback_challenges || 'ï¼ˆæœªå¡«å¯«ï¼‰'}</p>
                            </div>
                            <div>
                                <p className="text-sm text-blue-800 font-bold uppercase mb-2">ğŸ¯ æœªä¾†è§’è‰²æ¢ç´¢</p>
                                <p className="text-gray-700 whitespace-pre-wrap leading-relaxed">{formData.feedback_goals || 'ï¼ˆæœªå¡«å¯«ï¼‰'}</p>
                            </div>
                        </div>
                    </div>


                    {/* Signature */}
                    <div className="mt-12 pt-8 border-t-2 border-gray-200 print-break-inside-avoid">
                        <div className="grid grid-cols-2 gap-12">
                           <div>
                             <p className="text-sm text-gray-500 mb-12">å¤¥ä¼´ç°½åï¼š</p>
                             <div className="border-b border-gray-300"></div>
                           </div>
                           <div>
                             <p className="text-sm text-gray-500 mb-12">ä¸»ç®¡ç°½æ ¸ / æ—¥æœŸï¼š</p>
                             <div className="border-b border-gray-300"></div>
                           </div>
                        </div>
                    </div>
                </div>
            );


            // ä¸»ç•«é¢ (Main Edit Screen)
            return (
                <div className="min-h-screen bg-gray-100 font-sans">
                    {/* Navbar */}
                    <div className="sticky top-0 z-50 bg-white border-b shadow-sm px-4 md:px-6 py-3 flex flex-col md:flex-row justify-between items-center no-print gap-3">
                        <div className="flex items-center gap-2">
                            <Award className="text-blue-600" />
                            <h1 className="font-bold text-gray-800 hidden md:block">Self Review <span className="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full ml-2">Video Editor</span></h1>
                        </div>


                        <div className="hidden md:flex items-center gap-4 bg-gray-50 px-3 py-1 rounded-lg border border-gray-200">
                            <div className="flex items-center gap-2 text-sm text-gray-600">
                                <Calculator size={14} />
                                <span>è‡ªè©•ç¸½åˆ†: <b className="text-blue-600">{stats.totalScore}</b></span>
                            </div>
                            <div className="w-px h-4 bg-gray-300"></div>
                            <div className="text-sm text-gray-600">
                                <span>å¹³å‡: <b className="text-blue-600">{stats.averageScore}</b></span>
                            </div>
                        </div>


                        <div className="flex gap-2">
                            {viewMode === 'edit' ? (
                                <button
                                    onClick={() => setViewMode('preview')}
                                    className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm text-sm font-medium"
                                >
                                    <Save size={18} />
                                    <span className="hidden md:inline">é è¦½å ±å‘Š</span>
                                    <span className="md:hidden">é è¦½</span>
                                </button>
                            ) : (
                                <>
                                    <button
                                        onClick={submitToGoogleSheets}
                                        disabled={isSubmitting}
                                        className="flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors shadow-sm text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed"
                                    >
                                        {isSubmitting ? <Loader size={18} className="animate-spin" /> : <CloudUpload size={18} />}
                                        <span className="hidden md:inline">{isSubmitting ? 'ä¸Šå‚³ä¸­...' : 'ä¸Šå‚³é›²ç«¯'}</span>
                                        <span className="md:hidden">ä¸Šå‚³</span>
                                    </button>


                                    <button
                                        onClick={() => setViewMode('edit')}
                                        className="flex items-center gap-2 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium"
                                    >
                                        è¿”å›ç·¨è¼¯
                                    </button>
                                   
                                    <button
                                        onClick={() => window.print()}
                                        className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm text-sm font-medium"
                                    >
                                        <Printer size={18} />
                                        <span className="hidden md:inline">åˆ—å° / è½‰ PDF</span>
                                        <span className="md:hidden">PDF</span>
                                    </button>
                                </>
                            )}
                        </div>
                    </div>


                    {viewMode === 'preview' ? (
                        <div className="py-10 print:p-0">
                            <PreviewSheet />
                        </div>
                    ) : (
                        <div className="max-w-3xl mx-auto py-10 px-4 md:px-0">
                            <div className="bg-white rounded-xl shadow-lg overflow-hidden">
                                <div className="bg-blue-600 p-8 text-white">
                                    <h2 className="text-2xl font-bold mb-2">å¤¥ä¼´è‡ªæˆ‘æˆé•·å›é¡§</h2>
                                    <p className="opacity-90 text-sm">è«‹æ”¾é¬†å¿ƒæƒ…å¡«å¯«ï¼Œé€™æ˜¯é—œæ–¼ä½ çš„è©¦ç”¨æœŸæˆé•·å›é¡§ã€‚</p>
                                </div>


                                <div className="p-8">
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">å¤¥ä¼´å§“å</label>
                                            <input type="text" name="employeeName" value={formData.employeeName} onChange={handleInputChange} className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all" placeholder="è«‹è¼¸å…¥å§“å" />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">å¡«è¡¨æ—¥æœŸ</label>
                                            <input type="date" name="date" value={formData.date} onChange={handleInputChange} className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" />
                                        </div>
                                    </div>


                                    {/* åœ¨å¡«å¯«é é¢åŠ å…¥è©•åˆ†æ¨™æº– */}
                                    <ScoringLegend />


                                    {categories.map((cat) => (
                                        <div key={cat.id} className="mb-10">
                                            <SectionHeader icon={cat.icon} title={cat.title} desc={cat.desc} />
                                            {cat.items.map((item) => (
                                                <RatingInput key={item.id} label={item.label} sub={item.sub} value={formData[item.id]} onChange={(val) => handleScoreChange(item.id, val)} />
                                            ))}
                                        </div>
                                    ))}


                                    <div className="mb-10">
                                        <SectionHeader icon={<MessageSquare className="w-5 h-5 text-purple-500" />} title="å››ã€é›™å‘å°è©± (Feedback Loop)" desc="çœŸèª çš„å°è©±æ˜¯æˆé•·çš„åŸºçŸ³" />
                                        <div className="space-y-6">
                                            <div className="bg-blue-50 p-6 rounded-xl border border-blue-100">
                                                <h4 className="font-bold text-blue-800 mb-4 flex items-center gap-2"><span className="bg-blue-200 p-1 rounded text-xs">å¿…å¡«</span> è‡ªæˆ‘å›é¡§</h4>
                                                <div className="space-y-4">
                                                    <div>
                                                        <label className="block text-sm font-bold text-gray-700 mb-1">âœ¨ äº®é»å›é¡§ï¼šé€™æ®µæ™‚é–“ï¼Œä½ æœ€å–œæ­¡æˆ–è¦ºå¾—æœ‰é€²æ­¥çš„ä¸€æ¬¡ç”¢å‡ºï¼Ÿ</label>
                                                        <textarea name="feedback_highlight" value={formData.feedback_highlight} onChange={handleInputChange} rows="3" className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" placeholder="ä¸ç”¨å¾ˆæœ‰å£“åŠ›ï¼å¯ä»¥æ˜¯å­¸æœƒäº†ä¸€å€‹æ–°ç‰¹æ•ˆã€å‰ªäº†ä¸€æ”¯ç¯€å¥å¾ˆé †çš„ç‰‡..."></textarea>
                                                    </div>
                                                    <div>
                                                        <label className="block text-sm font-bold text-gray-700 mb-1">ğŸš§ å¡é—œèˆ‡æŒ‘æˆ°ï¼šè¦ºå¾—æ¯”è¼ƒè²»åŠ›çš„åœ°æ–¹ï¼Ÿ</label>
                                                        <textarea name="feedback_challenges" value={formData.feedback_challenges} onChange={handleInputChange} rows="3" className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" placeholder="ä¾‹å¦‚ï¼šç´ ææœå°‹èŠ±å¤ªå¤šæ™‚é–“ã€ç‰¹æ•ˆè»Ÿé«”é‚„ä¸ç†Ÿ..."></textarea>
                                                    </div>
                                                    <div>
                                                        <label className="block text-sm font-bold text-gray-700 mb-1">ğŸ¯ æœªä¾†è§’è‰²æ¢ç´¢ï¼šåŠå¹´å¾Œçš„ä½ ï¼Œå¸Œæœ›è‡ªå·±é•·æˆä»€éº¼æ¨£å­ï¼Ÿ</label>
                                                        <textarea name="feedback_goals" value={formData.feedback_goals} onChange={handleInputChange} rows="3" className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" placeholder="ä¸ç”¨ä¾·é™è·ç¨±ï¼ä¾‹å¦‚ï¼šæƒ³æ›´èƒ½æŒæ¡ä¼åŠƒé‚è¼¯ã€æƒ³å˜—è©¦å¸¶é ˜å°ˆæ¡ˆ..."></textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                    <div className="flex justify-end pt-6 border-t">
                                        <button onClick={() => setViewMode('preview')} className="px-8 py-3 bg-blue-600 text-white font-bold rounded-xl shadow-lg hover:bg-blue-700 transform hover:-translate-y-1 transition-all flex items-center gap-2">
                                            <Save size={20} />
                                            å„²å­˜ä¸¦é è¦½å ±å‘Š
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div className="text-center mt-8 text-gray-400 text-sm no-print">æœ¬ç³»çµ±å…§å®¹åƒ…ä¾›å…§éƒ¨è‡ªè©•ä½¿ç”¨ã€‚</div>
                        </div>
                    )}
                </div>
            );
        };


        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<EvaluationForm />);
    </script>
</body>
</html>

